# Домашнее задание: Резервное копирование с BorgBackup

## Цель домашнего задания
Научиться настраивать резервное копирование с помощью утилиты BorgBackup.

## Задание
Настроить стенд Vagrant с двумя виртуальными машинами: backup_server и client.
Настроить удаленный бэкап каталога /etc c сервера client при помощи borgbackup.

## Требования к резервным копиям:
- Директория для резервных копий /var/backup (отдельная точка монтирования, 2GB)
- Репозиторий зашифрован ключом
- Имя бэкапа содержит информацию о времени
- Глубина бекапа: год, хранить по последней копии на конец месяца, кроме последних трех месяцев
- Последние три месяца содержат копии на каждый день
- Резервная копия снимается каждые 5 минут (для демонстрации)
- Скрипт для снятия резервных копий запускается через systemd timer
- Настроено логирование с ротацией логов

## Схема сети
+-------------+ +-----------------+
| Client | | Backup Server |
| 192.168.11.150 | <----> | 192.168.11.160 |
| | SSH | |
+-------------+ +-----------------+

## Особенности реализации

### 1. Архитектура
- **Client**: Генерирует бэкапы и отправляет на backup server
- **Backup Server**: Хранит зашифрованные бэкапы на выделенном диске

### 2. Безопасность
- Репозитории Borg зашифрованы с использованием repokey
- SSH соединение с ключевой аутентификацией
- Изолированная сеть между машинами

### 3. Политика хранения
- **Ежедневные бэкапы**: Хранятся 90 дней
- **Еженедельные бэкапы**: Хранятся 4 недели
- **Ежемесячные бэкапы**: Хранятся 12 месяцев
- **Годовые бэкапы**: Хранятся 1 год

### 4. Автоматизация
- Systemd timer запускает бэкап каждые 5 минут
- Скрипт включает создание бэкапа, очистку старых и проверку целостности
- Логирование в syslog и файл с ротацией

## Развертывание

### Предварительные требования
- Vagrant 2.2.19+
- VirtualBox 6.1+
- Ansible 2.8+

### Запуск стенда
```bash
git clone <repository-url>
cd borg-backup
vagrant up
